<% layout('pages/base_layout') %>
<div class="container mt-4">
    <div class="d-flex justify-content-between align-items-center mb-3">
        <h2 class="mb-0">Daftar <%=table_name%></h2>
        <a href="<%=form_route%>" class="btn btn-success shadow-sm fw-semibold px-4 py-2 rounded-pill">
            + Tambah
        </a>
    </div>



    <table class="table table-bordered table-striped table-hover">
        <thead class="table-dark">
        <tr>
            <% if (datas.length > 0 && typeof datas !== undefined) { %>
                <th>No</th>
                <% Object.entries(datas[0]).forEach(([key]) => {%>
                    <%if(key != 'id') {%>
                        <th><%= key.replace(/_/g, " ").replace(/\b\w/g, c => c.toUpperCase()) %></th>
                    <%}%>
                <%});%>
                <th>Actions</th>
            <% } %>
        </tr>
        <% if (datas.length > 0  && typeof datas !== undefined) { %>
        </thead>
        <tbody>
            <% datas.forEach((row, index) => { %>
            <tr>
                <td><%=(index + 1) + offset%></td>
                <% Object.entries(row).forEach(([key, val]) => { %>
                    <% if (key !== 'id') {%>
                        <td><%-val%></td>
                    <% } else { %>
                        
                    <% } %>
                <% }) %>
                <td>
                    <a href="<%=view_route%><%= row.id %>" class="btn btn-info btn-sm">
                        View
                    </a>
                    <button type="submit" form="delete_form" href="" class="btn btn-danger btn-sm">
                        Delete
                    </button>
                        <form id="delete_form" onsubmit="return confirm('Are you sure you want to delete this object?')" method="post" action="<%=delete_route%><%= row.id %>"></form>
                </td>
            </tr>
            <% }) %>
            
        <% } else { %>
            <td colspan="100%" class="text-center py-3">
                <h2>This table is empty</h2>
            </td>
        <% } %>
        </tbody>
    </table>

    <!-- Pagination Controls -->
    <div class="d-flex justify-content-between">
        <button class="btn btn-secondary" onclick="goToPage(<%=Number(currentPage) - 1%>)"
                <%=currentPage <= 1 ? 'disabled' : ''%> di>
            Previous
        </button>

        <span>Page <%=currentPage%> of <%=total_pages%></span>

        <button class="btn btn-primary" onclick="goToPage(<%=Number(currentPage) + 1%>)"
                <%=currentPage >= total_pages ? 'disabled' : ''%>>
            Next
        </button>
    </div>
</div>


<script src="/js/table_list_page.js"></script>
