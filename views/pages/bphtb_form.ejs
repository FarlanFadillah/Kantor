<% layout('pages/base_layout') %>
<div class="container py-5">
    <div class="card shadow-sm">
        <div class="card-body">
            <h1 class="mb-4">Form BPHTB</h1>
            <form action="<%=form_action%>" method="POST" id="bphtb_form">
                <div class="row g-3">
                    <!-- Produk -->
                    <div class="col-md-6">
                        <label for="produk" class="form-label">Produk <span class="text-danger">*</span></label>
                        <select id="produk" name="produk" class="form-select">
                            <option value="">-- Pilih Produk --</option>
                            <option value="AJB" <%= form_data?.produk === "AJB" ? 'selected' : ''%> >AJB</option>
                            <option value="HIBAH" <%= form_data?.produk === "HIBAH" ? 'selected' : ''%>>HIBAH</option>
                            <option value="WARIS" <%= form_data?.produk === "WARIS" ? 'selected' : ''%>>WARIS</option>
                            <option value="APHB" <%= form_data?.produk === "APHB" ? 'selected' : ''%>>APHB</option>
                            <option value="HAK_BARU" <%= form_data?.produk === "HAK_BARU" ? 'selected' : ''%>>HAK BARU</option>
                        </select>
                    </div>

                    <!-- Alas Hak -->
                    <div class="col-md-6">
                        <label for="no_alas_hak" class="form-label">No. Alas Hak <span class="text-danger">*</span></label>
                        <input type="text" id="no_alas_hak" class="form-control" required value="<%=form_data?.no_alas_hak || ''%>">

                        <input hidden type="text" id="alas_hak_id" name="alas_hak_id" class="form-control" value="<%= form_data?.alas_hak_id || ''%>">

                        <label for="alas_hak" class="form-label">Alas Hak<span class="text-danger">*</span></label>
                        <input type="text" id="alas_hak" class="form-control" required readonly value="<%=form_data?.no_alas_hak || ''%>/<%= form_data?.alas_hak_kel || '' %>" style="background-color: lightgray">

                    </div>

                    <!-- Pbb / SKNJOP -->
                    <div class="col-md-6">

                        <label for="nop" class="form-label">NOP</span></label>
                        <div class="input-group mb-3">
                            <input type="text" id="nop" class="form-control" value="<%=form_data?.nop || ''%>">

                            <% if(form_data?.nop) {%>
                                <span class="input-group-text bg-transparent border-0" id="nop-status">
                                    <i class="bi bi-check-circle-fill text-success"></i>
                                </span>
                            <% } else { %>
                                <span class="input-group-text bg-transparent border-0" id="nop-status">
                                    <i id="pbb_status" class="bi bi-x-circle-fill text-danger"></i>
                                </span>
                            <% } %>
                        </div>

                        <input hidden type="text" id="pbb_id" name="pbb_id" class="form-control" value="<%= form_data?.pbb_id || ''%>">

                    </div>

                    <!-- Wajib Pajak -->
                    <!--Nik For verify client-->
                    <div class="col-md-6">
                        <label for="nik_wajib_pajak" class="form-label">NIK<span class="text-danger">*</span></label>
                        <div class="input-group mb-3">
                            <input type="text" id="nik_wajib_pajak" class="form-control" value="<%=form_data?.nik_wajib_pajak || ''%>" >
                            <a href="/client/form" target="_blank" class="btn btn-primary">+</a>
                        </div>


                        <input hidden type="text" id="id_wajib_pajak" name="wajib_pajak" class="form-control" value="<%= form_data?.wajib_pajak || '' %>">

                        <label for="wajib_pajak" class="form-label">Wajib Pajak <span class="text-danger">*</span></label>
                        <input type="text" id="wajib_pajak" class="form-control" readonly value="<%=form_data?.first_name || ''%> <%=form_data?.last_name || ''%>" style="background-color: lightgray">
                    </div>

                    <!-- Hasil Survei -->
                    <div class="col-md-6">
                        <label for="hasil_survei" class="form-label">Hasil Survei</label>
                        <input type="number" id="hasil_survei" name="hasil_survei" class="form-control" min="0" step="1" value="<%=form_data?.hasil_survei || ''%>">
                    </div>

                    <!-- Tanggal Survei -->
                    <div class="col-md-6">
                        <label for="tgl_survei" class="form-label">Tanggal Survei</label>
                        <input type="date" id="tgl_survei" name="tgl_survei" class="form-control" value="<%=form_data?.tgl_survei || ''%>">
                    </div>

                    <!-- Status -->
                    <div class="col-12">
                        <label for="status" class="form-label">Status</label>
                        <textarea id="status" name="status" class="form-control" rows="2" placeholder="Tuliskan status (opsional)" ><%=form_data?.status || ''%></textarea>
                    </div>

                    <!-- Checkbox -->
                    <div class="col-12">
                        <div class="form-check form-check-inline">
                            <input class="form-check-input" type="checkbox" id="perintah_bayar" name="perintah_bayar" <%=form_data?.perintah_bayar ? 'checked' : ''%>>
                            <label class="form-check-label" for="perintah_bayar">Perintah Bayar</label>
                        </div>

                        <div class="form-check form-check-inline">
                            <input class="form-check-input" type="checkbox" id="lunas" name="lunas" <%=form_data?.lunas ? 'checked' : ''%>>
                            <label class="form-check-label" for="lunas">Lunas</label>
                        </div>

                        <div class="form-check form-check-inline">
                            <input class="form-check-input" type="checkbox" id="selesai" name="selesai" <%=form_data?.selesai ? 'checked' : ''%>>
                            <label class="form-check-label" for="selesai">Selesai</label>
                        </div>
                    </div>

                    <!-- Submit Button -->
                    <div class="col-12 d-flex gap-2">
                        <button type="submit" form="bphtb_form" class="btn btn-primary">Simpan</button>
                        <button type="reset" class="btn btn-outline-secondary">Reset</button>
                        <a href="/admin/dashboard" class="btn btn-outline-primary">Dashboard</a>
                    </div>

                </div>
            </form>
        </div>
    </div>
</div>
<script src="/js/bphtb_form_page.js"></script>
